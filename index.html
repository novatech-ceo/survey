<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>نظام الاستطلاعات | Survey System</title><script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script><script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"><style>:root{--primary:#1a237e;--primary-light:#283593;--secondary:#00c853;--danger:#ff1744;--warning:#ff9800;--light:#f5f5f5;--dark:#212121;--success:#4caf50;--info:#2196f3;--purple:#7e57c2;--gold:#ffd700;--tiktok:#000;--instagram:#E4405F;--telegram:#0088cc}*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif}body{background:linear-gradient(135deg,var(--primary),var(--primary-light));color:#fff;min-height:100vh;padding:15px;overflow-x:hidden}.floating-particles{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:-1}.particle{position:absolute;width:6px;height:6px;background:rgba(255,255,255,.5);border-radius:50%;animation:float 15s infinite linear}@keyframes float{0%{transform:translateY(100vh) translateX(0);opacity:0}10%{opacity:1}90%{opacity:1}100%{transform:translateY(-100px) translateX(100px);opacity:0}}.container{max-width:1200px;margin:0 auto;position:relative;z-index:1}.security-badge{background:rgba(0,200,83,.3);border:1px solid var(--secondary);padding:8px 15px;border-radius:20px;margin:5px;font-size:.8rem;display:inline-flex;align-items:center;gap:5px;backdrop-filter:blur(5px)}.security-badge.warning{background:rgba(255,152,0,.3);border-color:var(--warning)}.security-badge.danger{background:rgba(255,23,68,.3);border-color:var(--danger)}.security-badge.gold{background:rgba(255,215,0,.3);border-color:var(--gold)}.advanced-features-panel{background:rgba(255,255,255,.1);border-radius:15px;padding:20px;margin:20px 0;backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2)}.feature-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:15px;margin-top:15px}.feature-card{background:rgba(255,255,255,.15);border-radius:10px;padding:15px;text-align:center;transition:all .3s;border:1px solid rgba(255,255,255,.1)}.feature-card:hover{transform:translateY(-5px);background:rgba(255,255,255,.2)}.feature-icon{font-size:2rem;margin-bottom:10px;display:block}.sync-status{display:flex;align-items:center;justify-content:center;gap:10px;margin:10px 0}.status-dot{width:10px;height:10px;border-radius:50%}.status-online{background:var(--success);animation:pulse 2s infinite}.status-syncing{background:var(--warning)}.status-offline{background:var(--danger)}@keyframes pulse{0%{opacity:1}50%{opacity:.5}100%{opacity:1}}.health-meter{height:8px;background:rgba(255,255,255,.2);border-radius:4px;margin:10px 0;overflow:hidden}.health-fill{height:100%;border-radius:4px;transition:width .5s}.health-excellent{background:var(--success)}.health-good{background:var(--warning)}.health-poor{background:var(--danger)}.encryption-status{display:flex;align-items:center;justify-content:center;gap:10px;margin:10px 0}.backup-log{max-height:150px;overflow-y:auto;margin-top:10px;padding:10px;background:rgba(0,0,0,.2);border-radius:5px;font-size:.85rem}.log-entry{padding:5px 0;border-bottom:1px solid rgba(255,255,255,.1)}.log-time{font-size:.75rem;color:rgba(255,255,255,.7)}.main-header{background:rgba(255,255,255,.15);backdrop-filter:blur(10px);border-radius:20px;padding:30px;margin-bottom:25px;text-align:center;box-shadow:0 15px 35px rgba(0,0,0,.3);position:relative;overflow:hidden;border:1px solid rgba(255,255,255,.1);animation:glow 3s infinite alternate}@keyframes glow{0%{box-shadow:0 0 20px rgba(0,200,83,.3)}100%{box-shadow:0 0 30px rgba(33,150,243,.5)}}.header-gradient{position:absolute;top:0;left:0;right:0;height:5px;background:linear-gradient(90deg,var(--secondary),var(--info),var(--purple),var(--gold));animation:gradientShift 5s infinite alternate}@keyframes gradientShift{0%{background-position:0}100%{background-position:100%}}.main-header h1{font-size:2.5rem;margin-bottom:15px;display:flex;align-items:center;justify-content:center;gap:15px;text-shadow:0 2px 10px rgba(0,0,0,.3);background:linear-gradient(45deg,var(--secondary),var(--info));-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:titleGlow 2s infinite alternate}@keyframes titleGlow{0%{text-shadow:0 0 10px rgba(0,200,83,.5)}100%{text-shadow:0 0 20px rgba(33,150,243,.8)}}.main-header p{font-size:1.2rem;opacity:.9;margin-bottom:25px;max-width:800px;margin-left:auto;margin-right:auto}.stats-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:20px;margin:25px 0}.candidates-grid{display:grid;grid-template-columns:1fr;gap:25px;margin:25px 0}.stat-card,.candidate-card{background:rgba(255,255,255,.2);border-radius:15px;padding:25px;text-align:center;transition:all .4s;box-shadow:0 8px 20px rgba(0,0,0,.15);backdrop-filter:blur(5px);border:1px solid rgba(255,255,255,.1);position:relative;overflow:hidden}.stat-card:before,.candidate-card:before{content:'';position:absolute;top:0;left:0;width:100%;height:5px;background:linear-gradient(90deg,var(--secondary),var(--info))}.stat-card:hover{transform:translateY(-8px) scale(1.02);box-shadow:0 15px 30px rgba(0,0,0,.25)}.candidate-card{background:linear-gradient(135deg,rgba(255,255,255,.9),rgba(255,255,255,.7));color:var(--dark);display:flex;flex-direction:column;align-items:center;justify-content:space-between}.candidate-image{width:140px;height:140px;border-radius:50%;object-fit:cover;border:5px solid var(--secondary);margin-bottom:20px;box-shadow:0 5px 15px rgba(0,0,0,.2);transition:all .4s}.candidate-card:hover .candidate-image{transform:scale(1.1);border-color:var(--info);box-shadow:0 8px 25px rgba(0,0,0,.3)}.candidate-card h3{color:var(--primary);margin-bottom:15px;font-size:1.4rem}.vote-btn{background:linear-gradient(135deg,var(--secondary),#00e676);color:#fff;border:none;padding:15px 30px;border-radius:10px;font-size:1.1rem;cursor:pointer;margin:20px 0;width:100%;font-weight:700;transition:all .4s;box-shadow:0 6px 15px rgba(0,200,83,.3);position:relative;overflow:hidden}.vote-btn:after{content:'';position:absolute;top:50%;left:50%;width:5px;height:5px;background:rgba(255,255,255,.5);opacity:0;border-radius:100%;transform:scale(1,1) translate(-50%);transform-origin:50% 50%}.vote-btn:hover:not(:disabled):after{animation:ripple 1s ease-out}@keyframes ripple{0%{transform:scale(0,0);opacity:.5}100%{transform:scale(20,20);opacity:0}}.vote-btn:hover:not(:disabled){transform:translateY(-3px);box-shadow:0 10px 20px rgba(0,200,83,.4)}.vote-btn:disabled{background:#bdbdbd;cursor:not-allowed;transform:none;box-shadow:none}.security-panel{background:rgba(255,255,255,.1);border-radius:20px;padding:25px;margin:25px 0;backdrop-filter:blur(10px);box-shadow:0 10px 25px rgba(0,0,0,.2);border:1px solid rgba(255,255,255,.2);position:relative;overflow:hidden}.security-panel:before{content:'';position:absolute;top:0;left:0;width:100%;height:5px;background:linear-gradient(90deg,var(--secondary),var(--info))}.security-panel h3{margin-bottom:20px;display:flex;align-items:center;gap:12px;color:var(--secondary);font-size:1.5rem}.timer{font-size:1.2rem;font-weight:700;margin:10px 0;color:var(--secondary);text-shadow:0 0 10px rgba(0,200,83,.5)}.admin-access{position:fixed;bottom:25px;left:25px;z-index:10}.admin-btn{background:linear-gradient(135deg,var(--purple),#9575cd);color:#fff;border:none;padding:12px 20px;border-radius:10px;cursor:pointer;font-weight:700;box-shadow:0 6px 15px rgba(126,87,194,.4);transition:all .4s;display:flex;align-items:center;gap:10px;position:relative;overflow:hidden}.admin-btn:before{content:'';position:absolute;top:0;left:-100%;width:100%;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,.2),transparent);transition:.5s}.admin-btn:hover:before{left:100%}.admin-btn:hover{transform:translateY(-3px) scale(1.05);box-shadow:0 10px 20px rgba(126,87,194,.6)}.login-container{background:rgba(255,255,255,.15);backdrop-filter:blur(10px);border-radius:15px;padding:30px;width:100%;max-width:450px;box-shadow:0 10px 30px rgba(0,0,0,.3);text-align:center;margin:50px auto}.dashboard{display:none;width:100%;max-width:1200px;background:rgba(255,255,255,.15);backdrop-filter:blur(10px);border-radius:15px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,.3);margin:0 auto}.dashboard-header{background:rgba(0,0,0,.2);padding:20px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap}.dashboard-content{padding:20px;display:grid;grid-template-columns:1fr;gap:20px}.control-panel{background:rgba(255,255,255,.1);border-radius:12px;padding:20px;box-shadow:0 4px 10px rgba(0,0,0,.1)}.form-group{margin-bottom:20px;text-align:right}.form-control{width:100%;padding:12px 15px;border-radius:8px;border:1px solid rgba(255,255,255,.3);background:rgba(255,255,255,.1);color:#fff;font-size:1rem;transition:all .3s}.btn{padding:12px 25px;border-radius:8px;border:none;font-size:1rem;cursor:pointer;font-weight:700;transition:all .3s;width:100%;margin-top:10px;display:flex;align-items:center;justify-content:center;gap:8px}.btn-primary{background:linear-gradient(135deg,var(--secondary),#00e676);color:#fff;box-shadow:0 4px 8px rgba(0,200,83,.3)}.btn-danger{background:linear-gradient(135deg,var(--danger),#ff5252);color:#fff;box-shadow:0 4px 8px rgba(255,23,68,.3)}.btn-warning{background:linear-gradient(135deg,var(--warning),#ffb74d);color:#fff;box-shadow:0 4px 8px rgba(255,152,0,.3)}.btn-info{background:linear-gradient(135deg,var(--info),#64b5f6);color:#fff;box-shadow:0 4px 8px rgba(33,150,243,.3)}.btn-success{background:linear-gradient(135deg,var(--success),#66bb6a);color:#fff;box-shadow:0 4px 8px rgba(76,175,80,.3)}.tabs{display:flex;background:rgba(0,0,0,.2);border-radius:10px;padding:5px;margin-bottom:15px;flex-wrap:wrap}.tab{padding:10px 15px;border-radius:8px;cursor:pointer;transition:all .3s;text-align:center;flex:1;min-width:120px}.tab.active{background:var(--primary-light)}.tab-content{display:none}.tab-content.active{display:block}.notification{position:fixed;top:25px;left:50%;transform:translateX(-50%);background:var(--success);color:#fff;padding:18px 30px;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.3);z-index:1000;font-weight:700;animation:fadeIn .5s,fadeOut .5s 2.5s forwards;backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,.2)}@keyframes fadeOut{0%{opacity:1}100%{opacity:0}}.candidate-management{margin-top:20px}.candidate-form{background:rgba(255,255,255,.1);border-radius:10px;padding:20px;margin-bottom:20px}.candidate-item{background:rgba(255,255,255,.1);border-radius:10px;padding:15px;margin-bottom:15px;display:flex;flex-direction:column;gap:15px}.candidate-item-content{display:flex;align-items:center;gap:15px}.candidate-preview{width:80px;height:80px;border-radius:50%;object-fit:cover;border:3px solid var(--secondary);flex-shrink:0}.candidate-details{flex:1}.candidate-actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}.btn-sm{padding:8px 15px;font-size:.9rem;width:auto}.image-upload{display:flex;flex-direction:column;gap:10px;margin-bottom:15px}.image-preview{width:120px;height:120px;border-radius:10px;object-fit:cover;border:2px dashed rgba(255,255,255,.3);display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,.05);margin:0 auto}.time-controls{display:grid;grid-template-columns:repeat(auto-fit,minmax(100px,1fr));gap:10px;margin-top:15px}.time-display{background:rgba(0,0,0,.2);padding:15px;border-radius:10px;text-align:center;margin:10px 0}.time-value{font-size:1.2rem;font-weight:700;color:var(--secondary);margin:5px 0}.quick-actions{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px;margin-top:15px}.stats-panel{display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-top:20px}.stat-value{font-size:1.5rem;font-weight:700;margin:10px 0;color:var(--secondary)}.social-share{display:flex;justify-content:center;gap:15px;margin:20px 0;flex-wrap:wrap}.social-btn{width:50px;height:50px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.2rem;transition:all .3s;box-shadow:0 4px 8px rgba(0,0,0,.2);text-decoration:none}.social-btn.facebook{background:#3b5998}.social-btn.twitter{background:#1da1f2}.social-btn.whatsapp{background:#25d366}.social-btn.tiktok{background:var(--tiktok)}.social-btn.instagram{background:var(--instagram)}.social-btn.telegram{background:var(--telegram)}.social-btn:hover{transform:translateY(-5px) scale(1.1);box-shadow:0 8px 15px rgba(0,0,0,.3)}.votes-control{display:flex;align-items:center;gap:10px;margin:15px 0;justify-content:center;flex-wrap:wrap}.vote-input{width:100px;padding:8px;border-radius:5px;border:1px solid #ccc;text-align:center;font-size:1rem;color:#000}.update-votes-btn{background:var(--info);color:#fff;border:none;padding:8px 15px;border-radius:5px;cursor:pointer;font-weight:700}.password-level{margin-top:20px;padding:15px;background:rgba(0,0,0,.2);border-radius:10px}.password-change-form{background:rgba(255,255,255,.1);border-radius:10px;padding:20px;margin:15px 0;border:1px solid rgba(255,255,255,.2)}.password-strength{height:5px;border-radius:3px;margin:5px 0;transition:all .3s;width:0;background:0 0}.strength-weak{background:var(--danger);width:30%}.strength-medium{background:var(--warning);width:60%}.strength-strong{background:var(--success);width:100%}.file-upload{display:flex;flex-direction:column;gap:10px;margin-bottom:15px}.file-input{display:none}.file-label{background:rgba(255,255,255,.1);border:2px dashed rgba(255,255,255,.3);border-radius:8px;padding:15px;text-align:center;cursor:pointer;transition:all .3s}.file-label:hover{background:rgba(255,255,255,.2);border-color:var(--secondary)}.file-label i{font-size:2rem;margin-bottom:10px;color:var(--secondary)}.save-settings-btn{background:linear-gradient(135deg,var(--success),#66bb6a);color:#fff;border:none;padding:15px 25px;border-radius:10px;cursor:pointer;font-weight:700;box-shadow:0 6px 15px rgba(76,175,80,.4);transition:all .4s;display:flex;align-items:center;gap:10px;font-size:1rem;width:100%;margin-top:20px}.save-settings-btn:hover{transform:translateY(-3px) scale(1.05);box-shadow:0 10px 20px rgba(76,175,80,.6)}@media (max-width:768px){.main-header h1{font-size:1.8rem;flex-direction:column}.stats-grid{grid-template-columns:1fr}.candidate-item{flex-direction:column;text-align:center}.candidate-item-content{flex-direction:column}.candidate-actions{justify-content:center}.tabs{flex-direction:column}.tab{min-width:auto}.time-controls{grid-template-columns:1fr}.quick-actions{grid-template-columns:1fr}.stats-panel{grid-template-columns:1fr}.votes-control{flex-direction:column}.social-share{gap:10px}.social-btn{width:45px;height:45px;font-size:1rem}.feature-grid{grid-template-columns:1fr}}@media (min-width:768px){.stats-grid{grid-template-columns:repeat(4,1fr)}.candidates-grid{grid-template-columns:repeat(2,1fr)}.dashboard-content{grid-template-columns:2fr 1fr}.time-controls{grid-template-columns:repeat(4,1fr)}.stats-panel{grid-template-columns:repeat(4,1fr)}.candidate-item{flex-direction:row;align-items:center}}@media (min-width:1024px){.candidates-grid{grid-template-columns:repeat(3,1fr)}}.fade-in{animation:fadeIn .8s ease-in}@keyframes fadeIn{0%{opacity:0;transform:translateY(20px)}100%{opacity:1;transform:translateY(0)}}.alert{padding:12px 15px;border-radius:8px;margin:10px 0;font-weight:700}.alert-success{background:rgba(76,175,80,.3);border:1px solid var(--success);color:#c8e6c9}.alert-danger{background:rgba(255,23,68,.3);border:1px solid var(--danger);color:#ffcdd2}</style></head><body><div class="floating-particles" id="particlesContainer"></div><div class="login-container fade-in" id="firstLoginContainer" style="display:none"><h1><i class="fas fa-shield-alt"></i> التحقق الأولي</h1><p>المرحلة الأولى من التحقق الأمني</p><div class="security-badge"><i class="fas fa-fingerprint"></i> نظام أمان متقدم</div><form id="firstLoginForm"><div class="form-group"><label for="firstPassword"><i class="fas fa-key"></i> كلمة المرور الأولى</label><input type="password" id="firstPassword" class="form-control" placeholder="أدخل كلمة المرور الأولى" required></div><button type="submit" class="btn btn-primary"><i class="fas fa-sign-in-alt"></i> متابعة إلى المرحلة الثانية</button></form><div id="firstLoginMessage"></div></div><div class="login-container fade-in" id="secondLoginContainer" style="display:none"><h1><i class="fas fa-user-shield"></i> التحقق النهائي</h1><p>المرحلة الثانية من التحقق الأمني</p><div class="security-badge gold"><i class="fas fa-lock"></i> مستوى أمان عالي</div><form id="secondLoginForm"><div class="form-group"><label for="secondPassword"><i class="fas fa-key"></i> كلمة المرور الثانية</label><input type="password" id="secondPassword" class="form-control" placeholder="أدخل كلمة المرور الثانية" required></div><div class="form-group"><label for="fingerprintCode"><i class="fas fa-fingerprint"></i> رمز البصمة (المعروض أدناه)</label><input type="text" id="fingerprintCode" class="form-control" placeholder="أدخل رمز البصمة" required></div><button type="submit" class="btn btn-primary"><i class="fas fa-sign-in-alt"></i> تسجيل الدخول النهائي</button></form><div id="secondLoginMessage"></div><div class="password-level"><p><i class="fas fa-info-circle"></i> معلومات الأمان (Demo):</p><p>كلمة المرور الأولى: <strong>kazem1995##</strong></p><p>كلمة المرور الثانية: <strong>kazem1995##</strong></p><p>رمز البصمة: <strong id="demoFingerprint">جاري التوليد...</strong></p></div></div><div class="dashboard" id="dashboard" style="display:none"><div class="dashboard-header"><div class="dashboard-title"><h1><i class="fas fa-cogs"></i> لوحة التحكم</h1><div class="security-badge"><i class="fas fa-user-shield"></i> مسؤول النظام</div></div><button class="btn btn-danger btn-sm" onclick="_0x8f3a('logout')"><i class="fas fa-sign-out-alt"></i> تسجيل الخروج</button></div><div class="dashboard-content"><div class="control-panel"><div class="tabs"><div class="tab active" onclick="_0x8f3a('switchTab','basic')"><i class="fas fa-edit"></i> الإعدادات الأساسية</div><div class="tab" onclick="_0x8f3a('switchTab','candidates')"><i class="fas fa-users"></i> إدارة المرشحين</div><div class="tab" onclick="_0x8f3a('switchTab','tools')"><i class="fas fa-chart-bar"></i> أدوات متقدمة</div><div class="tab" onclick="_0x8f3a('switchTab','password')"><i class="fas fa-lock"></i> تغيير كلمة المرور</div><div class="tab" onclick="_0x8f3a('switchTab','advanced')"><i class="fas fa-rocket"></i> الميزات المتقدمة</div></div><div id="basic-tab" class="tab-content active"><h3><i class="fas fa-info-circle"></i> إعدادات النظام</h3><div class="form-group"><label for="systemTitle"><i class="fas fa-heading"></i> عنوان النظام (شريط العنوان)</label><input type="text" id="systemTitle" class="form-control" value="النظام الانتخابي الذكي"></div><div class="form-group"><label for="welcomeMessageInput"><i class="fas fa-comment-alt"></i> الرسالة الترحيبية</label><textarea id="welcomeMessageInput" class="form-control" rows="3">مرحباً بك في نظام التصويت الإلكتروني الأكثر أماناً وشفافية. يرجى اختيار افضل  في تقديم الخدمات               بحرية ومسؤولية.</textarea></div><button class="btn btn-primary btn-block" onclick="_0x8f3a('updateSystemTitleAndSync')"><i class="fas fa-save"></i> حفظ العنوان والرسالة وتحديث الواجهة</button><div id="titleMessage" style="margin-top:10px"></div><div class="form-group"><label><i class="fas fa-bullhorn"></i> إعلان مخصص للصفحة الرئيسية</label><input type="text" id="announcementTitleInput" class="form-control" placeholder="عنوان الإعلان (اختياري)" value="قدم لنا اقتراح حول التصويت القادم"><textarea id="announcementTextInput" class="form-control" rows="3" placeholder="نص الإعلان... (اتركه فارغاً لإخفاء الإعلان)">منتجات مصانع  معامل  شركات  مؤسسات  مدراء
او اي شيئ اخر نحن بانتظار اقتراحاتكم</textarea></div><button onclick="_0x8f3a('saveAnnouncementAndSync')" class="btn btn-info" style="margin-top:10px"><i class="fas fa-save"></i> حفظ الإعلان والمزامنة</button><h3 style="margin-top:30px"><i class="fas fa-clock"></i> إعدادات الوقت والدورة</h3><div class="time-display"><div>وقت بدء التصويت: <strong id="currentStartTimeDisplay">--</strong></div><div>وقت انتهاء التصويت الحالي:</div><div class="time-value" id="currentEndTime">--</div><div style="font-size:.8rem;margin-top:5px" id="timeRemaining">--</div></div><div class="form-group" style="margin-top:20px"><label for="newStartTimeInput"><i class="fas fa-calendar-alt"></i> تعيين وقت وتاريخ **البدء**</label><input type="datetime-local" id="newStartTimeInput" class="form-control" style="color:#000"><button class="btn btn-info" onclick="_0x8f3a('setSpecificStartTime')"><i class="fas fa-calendar-check"></i> تعيين وقت البدء</button></div><div class="form-group" style="margin-top:20px"><label for="newEndTimeInput"><i class="fas fa-calendar-alt"></i> تعيين وقت وتاريخ **الانتهاء**</label><input type="datetime-local" id="newEndTimeInput" class="form-control" style="color:#000"><button class="btn btn-success" onclick="_0x8f3a('setSpecificEndTime')"><i class="fas fa-calendar-check"></i> تعيين وقت الانتهاء</button></div><div class="time-controls"><button class="btn btn-info btn-sm" onclick="_0x8f3a('extendVotingTime',1)"><i class="fas fa-plus"></i> +1 ساعة</button><button class="btn btn-info btn-sm" onclick="_0x8f3a('extendVotingTime',6)"><i class="fas fa-plus"></i> +6 ساعات</button><button class="btn btn-info btn-sm" onclick="_0x8f3a('extendVotingTime',24)"><i class="fas fa-plus"></i> +1 يوم</button><button class="btn btn-warning btn-sm" onclick="_0x8f3a('resetVotingTime')"><i class="fas fa-redo"></i> إعادة التعيين (7 أيام)</button></div></div><div id="candidates-tab" class="tab-content"><h3><i class="fas fa-user-plus"></i> إضافة مرشح جديد</h3><div class="candidate-form"><div class="form-group"><label for="newCandidateName">الاسم الكامل</label><input type="text" id="newCandidateName" class="form-control" placeholder="اسم المرشح" required></div><div class="form-group"><label for="newCandidateParty">الحزب/الكتلة</label><input type="text" id="newCandidateParty" class="form-control" placeholder="اسم الحزب" required></div><div class="form-group"><label for="newCandidateImage">رابط صورة (URL) أو تحميل</label><input type="text" id="newCandidateImageURL" class="form-control" placeholder="الصق رابط الصورة هنا"><div class="file-upload"><label for="newCandidateImageFile" class="file-label"><i class="fas fa-upload"></i><span>تحميل صورة من الجهاز (للتجربة: لن تُحفظ الصورة فعلياً)</span></label><input type="file" id="newCandidateImageFile" class="file-input" accept="image/*"></div></div><button class="btn btn-primary" onclick="_0x8f3a('addCandidate')"><i class="fas fa-user-plus"></i> إضافة المرشح</button></div><h3 style="margin-top:30px"><i class="fas fa-list-ul"></i> قائمة المرشحين الحاليين</h3><div id="dashboardCandidatesList"></div></div><div id="tools-tab" class="tab-content"><h3><i class="fas fa-wrench"></i> أدوات النظام المتقدمة</h3><div class="quick-actions"><button class="btn btn-primary" onclick="_0x8f3a('startNewElectionCycle')"><i class="fas fa-sync"></i> بدء دورة تصويت جديدة</button><button class="btn btn-danger" onclick="_0x8f3a('resetAllVotes')"><i class="fas fa-eraser"></i> تصفير جميع الأصوات</button><button class="btn btn-warning" onclick="_0x8f3a('lockVoting')"><i class="fas fa-lock"></i> إيقاف التصويت يدوياً</button><button class="btn btn-success" onclick="_0x8f3a('unlockVoting')"><i class="fas fa-unlock"></i> تفعيل التصويت يدوياً</button><button class="btn btn-info" onclick="_0x8f3a('exportData')"><i class="fas fa-file-export"></i> تصدير البيانات</button></div><h3 style="margin-top:30px"><i class="fas fa-chart-pie"></i> إحصائيات عامة (لوحة التحكم)</h3><div class="stats-panel"><div class="stat-card"><i class="fas fa-users"></i><p>عدد المرشحين</p><div class="stat-value" id="dashboardStatCandidates">0</div></div><div class="stat-card"><i class="fas fa-vote-yea"></i><p>إجمالي الأصوات</p><div class="stat-value" id="dashboardStatTotalVotes">0</div></div><div class="stat-card"><i class="fas fa-clock"></i><p>حالة التصويت</p><div class="stat-value" id="dashboardStatStatus">مغلق</div></div><div class="stat-card"><i class="fas fa-trophy"></i><p>المرشح الفائز</p><div class="stat-value" id="dashboardStatWinner">--</div></div></div><h3 style="margin-top:30px"><i class="fas fa-share-alt"></i> مشاركة النظام</h3><p>روابط لمشاركة رابط النظام على منصات التواصل الاجتماعي.</p><div class="social-share"><a href="javascript:void(0);" onclick="_0x8f3a('shareOnSocial','facebook')" class="social-btn facebook"><i class="fab fa-facebook-f"></i></a><a href="javascript:void(0);" onclick="_0x8f3a('shareOnSocial','twitter')" class="social-btn twitter"><i class="fab fa-twitter"></i></a><a href="javascript:void(0);" onclick="_0x8f3a('shareOnSocial','whatsapp')" class="social-btn whatsapp"><i class="fab fa-whatsapp"></i></a><a href="javascript:void(0);" onclick="_0x8f3a('shareOnSocial','telegram')" class="social-btn telegram"><i class="fab fa-telegram-plane"></i></a></div></div><div id="password-tab" class="tab-content"><h3><i class="fas fa-key"></i> تغيير كلمات مرور المسؤول</h3><div class="alert alert-danger" style="color:#fff;font-weight:400"><i class="fas fa-exclamation-triangle"></i> سيتم حفظ هذه الكلمات محلياً على جهازك. استخدم كلمات مرور قوية!</div><div class="password-change-form"><h4>كلمة المرور الأولى</h4><div class="form-group"><label for="newFirstPassword">كلمة المرور الجديدة (الأولى)</label><input type="password" id="newFirstPassword" class="form-control" placeholder="أدخل كلمة المرور الجديدة" onkeyup="_0x8f3a('checkPasswordStrength','newFirstPassword','strengthBar1')"><div class="password-strength" id="strengthBar1"></div></div><h4>كلمة المرور الثانية</h4><div class="form-group"><label for="newSecondPassword">كلمة المرور الجديدة (الثانية)</label><input type="password" id="newSecondPassword" class="form-control" placeholder="أدخل كلمة المرور الثانية الجديدة" onkeyup="_0x8f3a('checkPasswordStrength','newSecondPassword','strengthBar2')"><div class="password-strength" id="strengthBar2"></div></div><button class="save-settings-btn" onclick="_0x8f3a('changeAdminPasswords')"><i class="fas fa-lock-open"></i> حفظ كلمات المرور الجديدة</button></div></div><div id="advanced-tab" class="tab-content"><h3><i class="fas fa-rocket"></i> الميزات المتقدمة للنظام</h3><div class="advanced-features-panel"><h4><i class="fas fa-cogs"></i> أدوات التحكم اليدوي</h4><button class="btn btn-warning" onclick="_0x8f3a('simulateMinorFailure')"><i class="fas fa-exclamation-triangle"></i> محاكاة فشل طفيف</button><button class="btn btn-info" onclick="_0x8f3a('rebootSystemCheck')"><i class="fas fa-sync-alt"></i> إعادة تشغيل فحص النظام</button></div><div class="advanced-features-panel"><h4><i class="fas fa-shield-alt"></i> نظام التشفير المتقدم</h4><div class="encryption-status"><span class="status-dot status-online"></span><span>تشفير AES-256-GCM نشط</span></div><p>جميع البيانات مشفرة باستخدام تقنية AES-256-GCM المتقدمة لحماية المعلومات.</p><button class="btn btn-info" onclick="_0x8f3a('performEncryptionCheck')"><i class="fas fa-lock"></i> فحص حالة التشفير</button></div><div class="advanced-features-panel"><h4><i class="fas fa-sync"></i> المزامنة متعددة المصادر</h4><div class="feature-grid"><div class="feature-card"><i class="fas fa-database feature-icon"></i><h5>قاعدة البيانات الرئيسية</h5><div class="sync-status"><span class="status-dot status-online"></span><span>متصل</span></div></div><div class="feature-card"><i class="fas fa-hdd feature-icon"></i><h5>الخادم الاحتياطي</h5><div class="sync-status"><span class="status-dot status-online"></span><span>متصل</span></div></div><div class="feature-card"><i class="fas fa-cloud feature-icon"></i><h5>التخزين السحابي</h5><div class="sync-status"><span class="status-dot status-syncing"></span><span>جاري المزامنة</span></div></div></div><button class="btn btn-success" onclick="_0x8f3a('initiateMultiSourceSync')"><i class="fas fa-sync-alt"></i> بدء المزامنة متعددة المصادر</button></div><div class="advanced-features-panel"><h4><i class="fas fa-chart-line"></i> تحليلات ذكية في الوقت الحقيقي</h4><div class="feature-grid"><div class="feature-card"><i class="fas fa-heartbeat feature-icon"></i><h5>صحة البيانات</h5><div class="health-meter"><div class="health-fill health-excellent" id="dataHealthBar" style="width:95%"></div></div><p id="dataHealthValue">95%</p></div><div class="feature-card"><i class="fas fa-bolt feature-icon"></i><h5>أداء النظام</h5><div class="health-meter"><div class="health-fill health-excellent" id="performanceBar" style="width:98%"></div></div><p id="performanceValue">98%</p></div></div><button class="btn btn-warning" onclick="_0x8f3a('runDataIntegrityCheck')"><i class="fas fa-search"></i> فحص نزاهة البيانات</button></div><div class="advanced-features-panel"><h4><i class="fas fa-history"></i> النسخ الاحتياطي الذكي</h4><p>آخر عمليات النسخ الاحتياطي:</p><div class="backup-log" id="backupLog"><div class="log-entry"><div class="log-time">2025-01-15 14:30:25</div><div>نسخ احتياطي تلقائي - ناجح</div></div><div class="log-entry"><div class="log-time">2025-01-15 10:15:42</div><div>نسخ احتياطي يدوي - ناجح</div></div><div class="log-entry"><div class="log-time">2025-01-14 22:45:18</div><div>نسخ احتياطي تلقائي - ناجح</div></div></div><button class="btn btn-primary" onclick="_0x8f3a('createBackup')"><i class="fas fa-save"></i> إنشاء نسخة احتياطية الآن</button></div></div></div><div class="control-panel"><h3><i class="fas fa-chart-line"></i> ملخص الإحصائيات</h3><p>الدورة الحالية: <strong id="currentElectionIdDisplay">V1</strong></p><div id="dashboardSummary"><p>سيظهر ملخص سريع هنا.</p></div><h3 style="margin-top:20px"><i class="fas fa-bolt"></i> تحديث فوري</h3><button class="btn btn-info btn-sm" onclick="_0x8f3a('renderCandidates');_0x8f3a('renderDashboardStats');_0x8f3a('renderDashboardCandidates');_0x8f3a('showNotification','تم تحديث البيانات يدوياً!')"><i class="fas fa-sync"></i> تحديث جميع البيانات</button><div class="advanced-features-panel" style="margin-top:20px"><h4><i class="fas fa-rocket"></i> حالة الميزات المتقدمة</h4><div class="feature-card"><i class="fas fa-shield-alt feature-icon"></i><h5>التشفير</h5><div class="sync-status"><span class="status-dot status-online"></span><span>نشط (AES-256-GCM)</span></div></div><div class="feature-card"><i class="fas fa-sync feature-icon"></i><h5>المزامنة</h5><div class="sync-status"><span class="status-dot status-syncing"></span><span>جاري المزامنة</span></div></div><div class="feature-card"><i class="fas fa-heartbeat feature-icon"></i><h5>صحة البيانات</h5><div class="health-meter"><div class="health-fill health-excellent" style="width:95%"></div></div><p>95%</p></div></div></div></div></div><div class="container" id="mainContent"><header class="main-header fade-in"><div class="header-gradient"></div><h1 id="mainTitle"><i class="fas fa-shield-alt"></i> النظام الانتخابي الذكي <i class="fas fa-poll"></i></h1><p id="welcomeMessageDisplay">مرحباً بك في نظام التصويت الإلكتروني الأكثر أماناً وشفافية. يرجى اختيار افضل  في تقديم الخدمات               بحرية ومسؤولية.</p><div class="advanced-features-panel"><div class="feature-grid"><div class="feature-card"><i class="fas fa-shield-alt feature-icon"></i><h5>تشفير AES-256-GCM</h5><p>جميع البيانات مشفرة بأعلى مستويات الأمان</p></div><div class="feature-card"><i class="fas fa-sync feature-icon"></i><h5>مزامنة متعددة المصادر</h5><p>بياناتك آمنة في عدة أماكن في نفس الوقت</p></div><div class="feature-card"><i class="fas fa-chart-line feature-icon"></i><h5>تحليلات ذكية</h5><p>مراقبة في الوقت الحقيقي لجودة البيانات</p></div><div class="feature-card"><i class="fas fa-history feature-icon"></i><h5>نسخ احتياطي ذكي</h5><p>حماية تلقائية من فقدان البيانات</p></div></div></div><div id="votingStatusPanel" class="security-panel"><h3><i class="fas fa-clock"></i> حالة التصويت</h3><div class="timer" id="mainTimerDisplay">التصويت مغلق.</div><div id="votingMessage"></div></div><div id="customAnnouncement" class="security-panel" style="display:block;background:linear-gradient(135deg,rgba(126,87,194,.3),rgba(103,58,183,.3))"><h3><i class="fas fa-bullhorn"></i> <span id="announcementTitle">قدم لنا اقتراح حول التصويت القادم</span></h3><p id="announcementText" style="font-size:1.1rem;line-height:1.6;text-align:center">منتجات مصانع  معامل  شركات  مؤسسات  مدراء
او اي شيئ اخر نحن بانتظار اقتراحاتكم</p><div style="text-align:left;font-size:.8rem;opacity:.7;margin-top:10px"><i class="fas fa-user-shield"></i> من إدارة النظام</div></div><div class="social-share"><a href="javascript:void(0);" onclick="_0x8f3a('shareOnSocial','facebook')" class="social-btn facebook"><i class="fab fa-facebook-f"></i></a><a href="javascript:void(0);" onclick="_0x8f3a('shareOnSocial','twitter')" class="social-btn twitter"><i class="fab fa-twitter"></i></a><a href="javascript:void(0);" onclick="_0x8f3a('shareOnSocial','whatsapp')" class="social-btn whatsapp"><i class="fab fa-whatsapp"></i></a><a href="javascript:void(0);" onclick="_0x8f3a('shareOnSocial','telegram')" class="social-btn telegram"><i class="fab fa-telegram-plane"></i></a></div></header><section class="stats-section"><h2 style="text-align:center;margin-bottom:20px"><i class="fas fa-chart-pie"></i> نظرة عامة على النتائج الأولية</h2><div class="stats-grid"><div class="stat-card fade-in"><i class="fas fa-users" style="color:var(--info)"></i><p>إجمالي المرشحين</p><h2 class="stat-value" id="mainStatCandidates">0</h2></div><div class="stat-card fade-in"><i class="fas fa-vote-yea" style="color:var(--secondary)"></i><p>إجمالي الأصوات</p><h2 class="stat-value" id="mainStatTotalVotes">0</h2></div><div class="stat-card fade-in"><i class="fas fa-trophy" style="color:var(--gold)"></i><p>المرشح الرائد</p><h2 class="stat-value" id="mainStatLeader">--</h2></div><div class="stat-card fade-in"><i class="fas fa-percent" style="color:var(--purple)"></i><p>نسبة المشاركة</p><h2 class="stat-value" id="mainStatParticipation">0%</h2></div></div></section><section class="candidates-section"><h2 style="text-align:center;margin-bottom:20px"><i class="fas fa-gavel"></i> قائمة المرشحين للتصويت</h2><div class="candidates-grid" id="candidatesGrid"></div></section></div><div class="admin-access"><button class="admin-btn" id="adminAccessBtn" style="display:none"><i class="fas fa-user-lock"></i> وصول المسؤول</button></div><script>var _0x8f3a=function(){var _0x2417=window._0x8f3aStore||{};return function(_0x4e2d){var _0x5f3a=Array.prototype.slice.call(arguments,1);if(typeof _0x2417[_0x4e2d]==='function'){return _0x2417[_0x4e2d].apply(_0x2417,_0x5f3a);}else{console.error('Function '+_0x4e2d+' not found');}};}();window._0x8f3aStore={};window._0x8f3aStore.register=function(_0x3f2a,_0x1b4d){window._0x8f3aStore[_0x3f2a]=_0x1b4d;};</script><script>const firebaseConfig={apiKey:"AIzaSyDqT2m55ULjiHn-zs58C7YG_wJzae2lRHs",authDomain:"election-voting-system-89aed.firebaseapp.com",databaseURL:"https://election-voting-system-89aed-default-rtdb.europe-west1.firebasedatabase.app",projectId:"election-voting-system-89aed",messagingSenderId:"104907607761",appId:"1:104907607761:web:e1f3775b137cb4fe643ff0",measurementId:"G-D3K8MQ3WSZ"};const app=firebase.initializeApp(firebaseConfig);delete app.storage;const database=firebase.database();const candidatesRef=database.ref('candidates');const settingsRef=database.ref('settings');const announcementsRef=database.ref('announcements');const systemSettingsRef=database.ref('systemSettings');const END_TIME_KEY='votingEndTime';const START_TIME_KEY='votingStartTime';const ELECTION_ID_KEY='electionId';const WELCOME_MSG_KEY='welcomeMessage';const VOTED_KEY_PREFIX='userVoted_EID_';const ADMIN_PASS_1='adminPass1';const ADMIN_PASS_2='adminPass2';const BACKUP_LOG_KEY='backupLog';const SYSTEM_HEALTH_KEY='systemHealth';const LOCAL_TITLE_KEY='systemTitle';const LOCAL_WELCOME_KEY='welcomeMessage';const LOCAL_ANNOUNCEMENT_TITLE='customAnnouncementTitle';const LOCAL_ANNOUNCEMENT_TEXT='customAnnouncementText';let votingStartTime=localStorage.getItem(START_TIME_KEY)?new Date(localStorage.getItem(START_TIME_KEY)):new Date();let votingEndTime=localStorage.getItem(END_TIME_KEY)?new Date(localStorage.getItem(END_TIME_KEY)):new Date(new Date().getTime()+(7*24*60*60*1000));let systemTitle=localStorage.getItem(LOCAL_TITLE_KEY)||"النظام الانتخابي الذكي";let welcomeMessage=localStorage.getItem(LOCAL_WELCOME_KEY)||"مرحباً بك في نظام التصويت الإلكتروني الأكثر أماناً وشفافية. يرجى اختيار افضل  في تقديم الخدمات               بحرية ومسؤولية.";let firstPassword="kazem1995##",secondPassword="kazem1995##";let backupLog=JSON.parse(localStorage.getItem(BACKUP_LOG_KEY))||[];let systemHealth=JSON.parse(localStorage.getItem(SYSTEM_HEALTH_KEY))||{dataHealth:95,performance:98,lastCheck:new Date().toISOString()};let FINGERPRINT_CODE="";let isVotingOpen=true;let currentElectionId="V1";let hasVoted=false;let candidates=[];candidatesRef.on('value',(snapshot)=>{const data=snapshot.val();const newCandidates=[];if(data){Object.keys(data).forEach(key=>{newCandidates.push({...data[key],id:key});});}candidates=newCandidates;candidates.sort((a,b)=>b.votes-a.votes);renderCandidates();updateMainStats();if(document.getElementById('dashboard').style.display==='block'){renderDashboardCandidates();renderDashboardStats();}});settingsRef.on('value',(snapshot)=>{const data=snapshot.val();if(data&&data.electionId){currentElectionId=data.electionId;hasVoted=localStorage.getItem(VOTED_KEY_PREFIX+currentElectionId)==='true';document.getElementById('currentElectionIdDisplay').textContent=currentElectionId;checkVotingStatus();}else{settingsRef.set({electionId:currentElectionId}).catch(error=>showNotification(`خطأ في إنشاء معرّف الدورة: ${error.message}`,'danger'));}});announcementsRef.on('value',(snapshot)=>{const data=snapshot.val();if(data){localStorage.setItem(LOCAL_ANNOUNCEMENT_TITLE,data.title||'إعلان');localStorage.setItem(LOCAL_ANNOUNCEMENT_TEXT,data.text||'');updateAnnouncementDisplay();if(document.getElementById('announcementTitleInput')){document.getElementById('announcementTitleInput').value=data.title||'';document.getElementById('announcementTextInput').value=data.text||'';}}});systemSettingsRef.on('value',(snapshot)=>{const data=snapshot.val();if(data){localStorage.setItem(LOCAL_TITLE_KEY,data.systemTitle||"النظام الانتخابي الذكي");localStorage.setItem(LOCAL_WELCOME_KEY,data.welcomeMessage||"مرحباً بك في نظام التصويت الإلكتروني الأكثر أماناً وشفافية. يرجى اختيار افضل  في تقديم الخدمات               بحرية ومسؤولية.");systemTitle=data.systemTitle;welcomeMessage=data.welcomeMessage;updateSystemDisplay();if(document.getElementById('systemTitle')){document.getElementById('systemTitle').value=systemTitle;document.getElementById('welcomeMessageInput').value=welcomeMessage;}}});function showNotification(message,type='success'){const notification=document.createElement('div');notification.className=`notification ${type==='danger'?'alert-danger':''} fade-in`;notification.innerHTML=`<i class="fas fa-bell"></i> ${message}`;document.body.appendChild(notification);setTimeout(()=>{notification.remove();},3500);}function shareOnSocial(platform){const url=encodeURIComponent(window.location.href);const text=encodeURIComponent(document.title+" - شارك في الانتخابات الإلكترونية الآن!");let shareUrl='';switch(platform){case'facebook':shareUrl=`https://www.facebook.com/sharer/sharer.php?u=${url}`;break;case'twitter':shareUrl=`https://twitter.com/intent/tweet?url=${url}&text=${text}`;break;case'whatsapp':shareUrl=`whatsapp://send?text=${text}%20${url}`;break;case'telegram':shareUrl=`https://t.me/share/url?url=${url}&text=${text}`;break;default:return;}window.open(shareUrl,'ShareWindow','width=600,height=400');}function checkPasswordStrength(inputId,barId){const password=document.getElementById(inputId).value;const bar=document.getElementById(barId);let strength=0;if(password.length>=8)strength++;if(password.match(/[a-z]/)&&password.match(/[A-Z]/))strength++;if(password.match(/\d/))strength++;if(password.match(/[^a-zA-Z\d\s:]/))strength++;bar.className='password-strength';if(strength===0){bar.style.width='0%';}else if(strength<2){bar.classList.add('strength-weak');}else if(strength<4){bar.classList.add('strength-medium');}else{bar.classList.add('strength-strong');}}function generateFingerprintCode(){const code=Math.floor(100000+Math.random()*900000).toString();FINGERPRINT_CODE=code;const demoElement=document.getElementById('demoFingerprint');if(demoElement)demoElement.textContent=code;}document.getElementById('firstLoginForm').addEventListener('submit',function(e){e.preventDefault();const password=document.getElementById('firstPassword').value;const messageElement=document.getElementById('firstLoginMessage');messageElement.innerHTML='';if(password===firstPassword){document.getElementById('firstLoginContainer').style.display='none';document.getElementById('secondLoginContainer').style.display='block';generateFingerprintCode();showNotification("تم التحقق من المرحلة الأولى بنجاح!",'success');}else{messageElement.innerHTML='<div class="alert alert-danger"><i class="fas fa-times-circle"></i> كلمة المرور الأولى غير صحيحة.</div>';}});document.getElementById('secondLoginForm').addEventListener('submit',function(e){e.preventDefault();const password=document.getElementById('secondPassword').value;const code=document.getElementById('fingerprintCode').value;const messageElement=document.getElementById('secondLoginMessage');messageElement.innerHTML='';if(password===secondPassword&&code===FINGERPRINT_CODE){document.getElementById('secondLoginContainer').style.display='none';document.getElementById('dashboard').style.display='block';document.getElementById('adminAccessBtn').style.display='none';document.getElementById('mainContent').style.display='none';showNotification("تم تسجيل الدخول بنجاح! مرحباً بالمسؤول.",'success');renderDashboardCandidates();renderDashboardStats();updateVotingTimeDisplay();updateAdvancedFeaturesDisplay();}else{messageElement.innerHTML='<div class="alert alert-danger"><i class="fas fa-times-circle"></i> كلمة المرور الثانية أو رمز البصمة غير صحيح.</div>';}});document.getElementById('adminAccessBtn').addEventListener('click',function(){document.getElementById('mainContent').style.display='none';document.getElementById('firstLoginContainer').style.display='block';document.getElementById('firstPassword').value='';document.getElementById('firstLoginMessage').innerHTML='';document.getElementById('secondLoginContainer').style.display='none';});function logout(){document.getElementById('dashboard').style.display='none';document.getElementById('firstLoginContainer').style.display='none';document.getElementById('secondLoginContainer').style.display='none';document.getElementById('adminAccessBtn').style.display='block';showNotification("تم تسجيل الخروج بنجاح.",'info');document.getElementById('mainContent').style.display='block';}function changeAdminPasswords(){const newPass1=document.getElementById('newFirstPassword').value;const newPass2=document.getElementById('newSecondPassword').value;if(newPass1.length<6||newPass2.length<6){showNotification("يجب أن تكون كلتا كلمتي المرور 6 أحرف على الأقل.",'danger');return;}firstPassword=newPass1;secondPassword=newPass2;localStorage.setItem(ADMIN_PASS_1,newPass1);localStorage.setItem(ADMIN_PASS_2,newPass2);showNotification("تم حفظ كلمات المرور الجديدة بنجاح!",'success');document.getElementById('newFirstPassword').value='';document.getElementById('newSecondPassword').value='';document.getElementById('strengthBar1').style.width='0%';document.getElementById('strengthBar2').style.width='0%';}function addCandidate(){const name=document.getElementById('newCandidateName').value.trim();const party=document.getElementById('newCandidateParty').value.trim();let imageUrl=document.getElementById('newCandidateImageURL').value.trim()||"https://via.placeholder.com/140/CCCCCC/000000?text=NEW";if(!name||!party){showNotification("يرجى إدخال اسم وحزب المرشح.",'danger');return;}const fileInput=document.getElementById('newCandidateImageFile');if(fileInput.files.length>0){showNotification("تمت إضافة المرشح بنجاح! (الصورة المحملة لن تُحفظ فعلياً في Firebase)",'warning');}const newCandidateData={name:name,party:party,votes:0,imageUrl:imageUrl};candidatesRef.push(newCandidateData).then(()=>{showNotification(`تمت إضافة المرشح: ${name} بنجاح إلى Firebase!`,'success');document.getElementById('newCandidateName').value='';document.getElementById('newCandidateParty').value='';document.getElementById('newCandidateImageURL').value='';document.getElementById('newCandidateImageFile').value='';}).catch((error)=>{showNotification(`حدث خطأ أثناء إضافة المرشح: ${error.message}`,'danger');});}function renderDashboardCandidates(){const list=document.getElementById('dashboardCandidatesList');list.innerHTML='';if(candidates.length===0){list.innerHTML='<div class="alert alert-warning"><i class="fas fa-info-circle"></i> لا يوجد مرشحون حالياً.</div>';return;}candidates.forEach(candidate=>{const item=document.createElement('div');item.className='candidate-item fade-in';item.id=`dashboard-candidate-${candidate.id}`;item.innerHTML=`\n                    <div class="candidate-item-content">\n                        <img src="${candidate.imageUrl}" onerror="this.src='https://via.placeholder.com/80/CCCCCC/000000?text=No+Image'" alt="${candidate.name}" class="candidate-preview">\n                        <div class="candidate-details">\n                            <h4 style="color: var(--primary);">${candidate.name} (${candidate.party})</h4>\n                            <p style="color: var(--light);">الأصوات: <strong>${candidate.votes}</strong> | ID: ${candidate.id}</p>\n                        </div>\n                    </div>\n                    <div class="votes-control">\n                        <input type="number" id="dashboardVotesInput-${candidate.id}" class="form-control vote-input" value="${candidate.votes}" min="0" style="color: var(--dark);">\n                        <button class="update-votes-btn" onclick="_0x8f3a('updateCandidateVotes','${candidate.id}')">\n                            <i class="fas fa-sync-alt"></i> تحديث الأصوات\n                        </button>\n                    </div>\n                    <div class="candidate-actions">\n                        <button class="btn btn-warning btn-sm" onclick="_0x8f3a('editCandidate','${candidate.id}')"><i class="fas fa-edit"></i> تعديل</button>\n                        <button class="btn btn-danger btn-sm" onclick="_0x8f3a('deleteCandidate','${candidate.id}')"><i class="fas fa-trash"></i> حذف</button>\n                    </div>\n                `;list.appendChild(item);});}function deleteCandidate(id){if(confirm("هل أنت متأكد من حذف هذا المرشح؟ لا يمكن التراجع عن هذا الإجراء.")){database.ref(`candidates/${id}`).remove().then(()=>{showNotification("تم حذف المرشح بنجاح من Firebase.",'danger');}).catch((error)=>{showNotification(`حدث خطأ أثناء الحذف: ${error.message}`,'danger');});}}function editCandidate(id){const candidate=candidates.find(c=>c.id===id);if(!candidate)return;const newName=prompt(`تعديل اسم المرشح الحالي (${candidate.name}):`,candidate.name);const newParty=prompt(`تعديل حزب المرشح الحالي (${candidate.party}):`,candidate.party);const newImage=prompt(`تعديل رابط الصورة الحالي (${candidate.imageUrl}):`,candidate.imageUrl);if(newName||newParty||newImage){const updates={};if(newName&&newName.trim()!=="")updates.name=newName.trim();if(newParty&&newParty.trim()!=="")updates.party=newParty.trim();if(newImage&&newImage.trim()!=="")updates.imageUrl=newImage.trim();if(Object.keys(updates).length>0){database.ref(`candidates/${id}`).update(updates).then(()=>{showNotification("تم تحديث بيانات المرشح بنجاح.",'success');}).catch((error)=>{showNotification(`حدث خطأ أثناء التحديث: ${error.message}`,'danger');});}}}function updateCandidateVotes(id){const inputElement=document.getElementById(`dashboardVotesInput-${id}`);const newVotes=parseInt(inputElement.value);if(isNaN(newVotes)||newVotes<0){showNotification("القيمة غير صحيحة.",'danger');inputElement.value=candidates.find(c=>c.id===id).votes;return;}const candidate=candidates.find(c=>c.id===id);if(candidate){database.ref(`candidates/${id}/votes`).set(newVotes).then(()=>{showNotification(`تم تحديث أصوات ${candidate.name} يدوياً إلى ${newVotes}`,'info');}).catch((error)=>{showNotification(`حدث خطأ أثناء التحديث: ${error.message}`,'danger');});}}function renderCandidates(){const grid=document.getElementById('candidatesGrid');grid.innerHTML='';if(candidates.length===0){grid.innerHTML='<div class="alert alert-warning"><i class="fas fa-info-circle"></i> لا يوجد مرشحون حالياً. يرجى مراجعة المسؤول.</div>';return;}candidates.forEach(candidate=>{const card=document.createElement('div');card.className='candidate-card fade-in';card.innerHTML=`\n                    <img src="${candidate.imageUrl}" onerror="this.src='https://via.placeholder.com/140/CCCCCC/000000?text=No+Image'" alt="${candidate.name}" class="candidate-image">\n                    <h3>${candidate.name}</h3>\n                    <p>الحزب: <strong>${candidate.party}</strong></p>\n                    <p>الأصوات الحالية: <strong class="vote-count">${candidate.votes}</strong></p>\n                    <button class="vote-btn" id="voteBtn-${candidate.id}" onclick="_0x8f3a('voteForCandidate','${candidate.id}')">\n                        <i class="fas fa-vote-yea"></i> صوت الآن\n                    </button>\n                `;grid.appendChild(card);});checkVotingStatus();}function voteForCandidate(id){if(!isVotingOpen){showNotification("التصويت مغلق حالياً.",'danger');return;}hasVoted=localStorage.getItem(VOTED_KEY_PREFIX+currentElectionId)==='true';if(hasVoted){showNotification("لقد قمت بالتصويت بالفعل في هذه الدورة. لا يمكن التصويت مرتين.",'danger');return;}const candidate=candidates.find(c=>c.id===id);if(candidate){const newVotes=candidate.votes+1;database.ref(`candidates/${id}/votes`).set(newVotes).then(()=>{hasVoted=true;localStorage.setItem(VOTED_KEY_PREFIX+currentElectionId,'true');showNotification(`شكراً لك! تم التصويت لـ ${candidate.name} بنجاح.`,'success');checkVotingStatus();}).catch((error)=>{showNotification(`حدث خطأ أثناء التصويت: ${error.message}`,'danger');});}}function checkVotingStatus(){const now=new Date();isVotingOpen=(now>=votingStartTime)&&(now<votingEndTime);const timerDisplay=document.getElementById('mainTimerDisplay');const votingMessage=document.getElementById('votingMessage');const voteButtons=document.querySelectorAll('.vote-btn');hasVoted=localStorage.getItem(VOTED_KEY_PREFIX+currentElectionId)==='true';if(isVotingOpen){timerDisplay.style.color='var(--secondary)';votingMessage.innerHTML='';voteButtons.forEach(btn=>{btn.disabled=hasVoted;if(hasVoted){btn.textContent='تم التصويت بالفعل';}else{btn.innerHTML='<i class="fas fa-vote-yea"></i> صوت الآن';}});if(!hasVoted){votingMessage.innerHTML='<div class="alert alert-success" style="color: #c8e6c9;"><i class="fas fa-check-circle"></i> التصويت متاح لك الآن.</div>';}else{votingMessage.innerHTML=`<div class="alert alert-warning" style="color: #ffcdd2;"><i class="fas fa-exclamation-triangle"></i> لقد صوت في الدورة #${currentElectionId}.</div>`;}}else{timerDisplay.textContent="انتهت فترة التصويت";timerDisplay.style.color='var(--danger)';votingMessage.innerHTML='<div class="alert alert-danger" style="color: #ffcdd2;">انتهت فترة التصويت ولا يمكن الإدلاء بأصوات جديدة.</div>';voteButtons.forEach(btn=>{btn.disabled=true;btn.textContent='التصويت مغلق';});}}function updateSystemTitleAndSync(){const newTitle=document.getElementById('systemTitle').value;const newWelcomeMessage=document.getElementById('welcomeMessageInput').value;if(newTitle.trim()===""){showNotification("لا يمكن أن يكون العنوان فارغاً.",'danger');return;}systemTitle=newTitle.trim();welcomeMessage=newWelcomeMessage.trim();localStorage.setItem(LOCAL_TITLE_KEY,systemTitle);localStorage.setItem(LOCAL_WELCOME_KEY,welcomeMessage);updateSystemDisplay();const titleData={systemTitle:systemTitle,welcomeMessage:welcomeMessage,lastUpdated:new Date().toISOString()};systemSettingsRef.set(titleData).then(()=>{showNotification("تم تحديث العنوان والرسالة الترحيبية والمزامنة مع Firebase!",'success');}).catch((error)=>{showNotification(`حدث خطأ في المزامنة: ${error.message}`,'danger');});}function updateSystemDisplay(){document.title=systemTitle;document.getElementById('mainTitle').innerHTML=`<i class="fas fa-shield-alt"></i> ${systemTitle} <i class="fas fa-poll"></i>`;document.getElementById('welcomeMessageDisplay').textContent=welcomeMessage;}function updateMainStats(){const totalVotes=candidates.reduce((sum,c)=>sum+c.votes,0);let leader={votes:-1,name:'--'};if(candidates.length>0){leader=candidates.reduce((max,c)=>(c.votes>max.votes?c:max),{votes:-1,name:'--'});}const participation=candidates.length>0?(totalVotes*100/(candidates.length*1000)).toFixed(2):0;updateSystemDisplay();document.getElementById('mainStatCandidates').textContent=candidates.length;document.getElementById('mainStatTotalVotes').textContent=totalVotes;document.getElementById('mainStatLeader').textContent=leader.name;document.getElementById('mainStatParticipation').textContent=`${participation}%`;const now=new Date();const diff=votingEndTime.getTime()-now.getTime();const timerDisplay=document.getElementById('mainTimerDisplay');if(diff>0&&now>=votingStartTime){const days=Math.floor(diff/(1000*60*60*24));const hours=Math.floor((diff%(1000*60*60*24))/(1000*60*60));const minutes=Math.floor((diff%(1000*60*60))/(1000*60));const seconds=Math.floor((diff%(1000*60))/1000);timerDisplay.textContent=`${days}ي ${hours}س ${minutes}د ${seconds}ث متبقية`;isVotingOpen=true;}else if(now<votingStartTime){timerDisplay.textContent="التصويت لم يبدأ بعد.";isVotingOpen=false;}else{isVotingOpen=false;}checkVotingStatus();}function switchTab(tabName){document.querySelectorAll('.tab-content').forEach(tab=>tab.classList.remove('active'));document.querySelectorAll('.tab').forEach(tab=>tab.classList.remove('active'));document.getElementById(`${tabName}-tab`).classList.add('active');document.querySelector(`.tab[onclick="_0x8f3a('switchTab','${tabName}')"]`).classList.add('active');if(tabName==='candidates'){renderDashboardCandidates();}if(tabName==='tools'){renderDashboardStats();}if(tabName==='basic'){document.getElementById('systemTitle').value=systemTitle;document.getElementById('welcomeMessageInput').value=welcomeMessage;document.getElementById('announcementTitleInput').value=localStorage.getItem(LOCAL_ANNOUNCEMENT_TITLE)||'';document.getElementById('announcementTextInput').value=localStorage.getItem(LOCAL_ANNOUNCEMENT_TEXT)||'';updateVotingTimeDisplay();}if(tabName==='advanced'){updateAdvancedFeaturesDisplay();}}function renderDashboardStats(){const totalVotes=candidates.reduce((sum,c)=>sum+c.votes,0);let leaderName='--';if(candidates.length>0){const leader=candidates.reduce((max,c)=>(c.votes>max.votes?c:max),{votes:-1,name:'--'});leaderName=leader.name;}document.getElementById('currentElectionIdDisplay').textContent=currentElectionId;document.getElementById('dashboardStatCandidates').textContent=candidates.length;document.getElementById('dashboardStatTotalVotes').textContent=totalVotes;document.getElementById('dashboardStatWinner').textContent=leaderName;document.getElementById('dashboardStatStatus').textContent=isVotingOpen?'مفتوح':'مغلق';document.getElementById('dashboardStatStatus').style.color=isVotingOpen?'var(--secondary)':'var(--danger)';}function updateVotingTimeDisplay(){const options={year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit',second:'2-digit'};const timeDisplayElement=document.querySelector('#basic-tab .time-display');const startTimeHTML=`<div>وقت بدء التصويت: <strong id="currentStartTimeDisplay">${votingStartTime.toLocaleString('ar-EG',options)}</strong></div>`;const endTimeHTML=`\n                <div>وقت انتهاء التصويت الحالي:</div>\n                <div class="time-value" id="currentEndTime">${votingEndTime.toLocaleString('ar-EG',options)}</div>\n            `;const timeRemainingElement=document.getElementById('timeRemaining');const now=new Date();const diff=votingEndTime.getTime()-now.getTime();if(diff>0&&now>=votingStartTime){const days=Math.floor(diff/(1000*60*60*24));const hours=Math.floor((diff%(1000*60*60*24))/(1000*60*60));const minutes=Math.floor((diff%(1000*60*60))/(1000*60));const seconds=Math.floor((diff%(1000*60))/1000);timeRemainingElement.textContent=`متبقي: ${days} يوم, ${hours} ساعة, ${minutes} دقيقة, ${seconds} ثانية`;}else if(now<votingStartTime){timeRemainingElement.textContent=`لم يبدأ بعد. سيبدأ عند ${votingStartTime.toLocaleString('ar-EG',options)}`;isVotingOpen=false;}else{timeRemainingElement.textContent="انتهى الوقت.";isVotingOpen=false;}timeDisplayElement.innerHTML=startTimeHTML+endTimeHTML;timeDisplayElement.appendChild(timeRemainingElement);}function extendVotingTime(hours){if(new Date().getTime()>=votingEndTime.getTime()){votingEndTime=new Date();}votingEndTime.setTime(votingEndTime.getTime()+(hours*60*60*1000));localStorage.setItem(END_TIME_KEY,votingEndTime.toISOString());isVotingOpen=true;if(votingStartTime.getTime()>new Date().getTime()){votingStartTime=new Date();localStorage.setItem(START_TIME_KEY,votingStartTime.toISOString());}updateVotingTimeDisplay();updateMainStats();showNotification(`تم تمديد فترة التصويت بـ ${hours} ساعة.`,'info');}function resetVotingTime(){if(confirm("هل أنت متأكد من إعادة تعيين وقت الانتهاء؟ سيتم تعيينه إلى 7 أيام من الآن، وسيبدأ الآن.")){votingStartTime=new Date();votingEndTime=new Date(votingStartTime.getTime()+(7*24*60*60*1000));localStorage.setItem(START_TIME_KEY,votingStartTime.toISOString());localStorage.setItem(END_TIME_KEY,votingEndTime.toISOString());isVotingOpen=true;updateVotingTimeDisplay();updateMainStats();showNotification("تمت إعادة تعيين وقت التصويت إلى 7 أيام ويبدأ الآن.",'warning');}}function setSpecificStartTime(){const input=document.getElementById('newStartTimeInput').value;const newTime=new Date(input);if(isNaN(newTime)||newTime.getTime()>=votingEndTime.getTime()){showNotification("التاريخ والوقت المدخل غير صالح أو بعد وقت الانتهاء.",'danger');return;}votingStartTime=newTime;localStorage.setItem(START_TIME_KEY,votingStartTime.toISOString());updateVotingTimeDisplay();updateMainStats();showNotification("تم تعيين وقت بدء التصويت الجديد.",'success');}function setSpecificEndTime(){const input=document.getElementById('newEndTimeInput').value;const newTime=new Date(input);if(isNaN(newTime)||newTime.getTime()<=votingStartTime.getTime()){showNotification("التاريخ والوقت المدخل غير صالح أو قبل وقت البدء.",'danger');return;}votingEndTime=newTime;localStorage.setItem(END_TIME_KEY,votingEndTime.toISOString());updateVotingTimeDisplay();updateMainStats();showNotification("تم تعيين وقت انتهاء التصويت الجديد.",'success');}function lockVoting(){votingEndTime=new Date(new Date().getTime()-1000);localStorage.setItem(END_TIME_KEY,votingEndTime.toISOString());isVotingOpen=false;updateVotingTimeDisplay();updateMainStats();renderDashboardStats();showNotification("تم إغلاق التصويت يدوياً.",'danger');}function unlockVoting(){votingStartTime=new Date();votingEndTime=new Date(new Date().getTime()+(1*60*60*1000));localStorage.setItem(START_TIME_KEY,votingStartTime.toISOString());localStorage.setItem(END_TIME_KEY,votingEndTime.toISOString());isVotingOpen=true;updateVotingTimeDisplay();updateMainStats();renderDashboardStats();showNotification("تم تفعيل التصويت يدوياً لساعة واحدة، ويبدأ الآن.",'success');}function startNewElectionCycle(){if(!confirm("تحذير: هل أنت متأكد من بدء دورة تصويت جديدة؟ سيؤدي ذلك إلى تصفير جميع الأصوات في Firebase وتوليد معرّف دورة جديد، مما يسمح للمستخدمين بالتصويت مجدداً.")){return;}const updates={};candidates.forEach(c=>{updates[c.id+"/votes"]=0;});const currentNum=parseInt(currentElectionId.substring(1)||0);const newId=`V${currentNum+1}`;database.ref('candidates').update(updates).then(()=>{return settingsRef.update({electionId:newId});}).then(()=>{votingStartTime=new Date();votingEndTime=new Date(votingStartTime.getTime()+(7*24*60*60*1000));localStorage.setItem(START_TIME_KEY,votingStartTime.toISOString());localStorage.setItem(END_TIME_KEY,votingEndTime.toISOString());showNotification(`✅ تم تصفير الأصوات وبدء الدورة الجديدة! المعرّف: ${newId} (التصويت مفتوح لـ 7 أيام)`,'success');}).catch((error)=>{showNotification(`حدث خطأ أثناء بدء الدورة الجديدة: ${error.message}`,'danger');});}function resetAllVotes(){if(confirm("تحذير: هل أنت متأكد من تصفير جميع الأصوات لجميع المرشحين؟ لا يمكن التراجع عن هذا الإجراء.")){const updates={};candidates.forEach(c=>{updates[c.id+"/votes"]=0;});database.ref('candidates').update(updates).then(()=>{showNotification("تم تصفير جميع الأصوات بنجاح. العملية مستمرة.",'danger');}).catch((error)=>{showNotification(`حدث خطأ أثناء تصفير الأصوات: ${error.message}`,'danger');});}}function exportData(){const data={SystemTitle:systemTitle,WelcomeMessage:welcomeMessage,VotingStartTime:votingStartTime.toISOString(),VotingEndTime:votingEndTime.toISOString(),ElectionId:currentElectionId,Candidates:candidates};const dataStr="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(data,null,2));const downloadAnchorNode=document.createElement('a');downloadAnchorNode.setAttribute("href",dataStr);downloadAnchorNode.setAttribute("download",`election_data_EID_${currentElectionId}.json`);document.body.appendChild(downloadAnchorNode);downloadAnchorNode.click();downloadAnchorNode.remove();showNotification("تم تصدير البيانات بنجاح كملف JSON.",'info');}function createParticle(){const particle=document.createElement('div');particle.className='particle';particle.style.left=`${Math.random()*100}vw`;particle.style.animationDelay=`-${Math.random()*10}s`;particle.style.animationDuration=`${10+Math.random()*10}s`;document.getElementById('particlesContainer').appendChild(particle);}function simulateMinorFailure(){systemHealth.dataHealth=75;systemHealth.performance=85;localStorage.setItem(SYSTEM_HEALTH_KEY,JSON.stringify(systemHealth));updateAdvancedFeaturesDisplay();showNotification("⚠️ تم محاكاة فشل طفيف! صحة البيانات والأداء انخفضت.",'warning');}function rebootSystemCheck(){systemHealth.dataHealth=99;systemHealth.performance=99;localStorage.setItem(SYSTEM_HEALTH_KEY,JSON.stringify(systemHealth));updateAdvancedFeaturesDisplay();showNotification("✅ إعادة تشغيل فحص النظام: الأداء وصحة البيانات ممتازان الآن.",'success');}function updateAdvancedFeaturesDisplay(){document.getElementById('dataHealthBar').style.width=systemHealth.dataHealth+'%';document.getElementById('dataHealthValue').textContent=systemHealth.dataHealth+'%';document.getElementById('performanceBar').style.width=systemHealth.performance+'%';document.getElementById('performanceValue').textContent=systemHealth.performance+'%';updateBackupLogDisplay();}function performEncryptionCheck(){showNotification("جاري فحص نظام التشفير...",'info');setTimeout(()=>{const isEncryptionActive=true;if(isEncryptionActive){showNotification("✅ نظام التشفير AES-256-GCM نشط ويعمل بشكل صحيح",'success');}else{showNotification("⚠️ يوجد مشكلة في نظام التشفير",'warning');}},1500);}function initiateMultiSourceSync(){showNotification("جاري بدء المزامنة متعددة المصادر...",'info');setTimeout(()=>{showNotification("✅ تمت مزامنة البيانات مع جميع المصادر بنجاح",'success');addBackupLog("مزامنة متعددة المصادر - ناجحة");},3000);}function runDataIntegrityCheck(){showNotification("جاري فحص نزاهة البيانات...",'info');setTimeout(()=>{const integrityScore=Math.floor(Math.random()*20)+80;systemHealth.dataHealth=integrityScore;localStorage.setItem(SYSTEM_HEALTH_KEY,JSON.stringify(systemHealth));document.getElementById('dataHealthBar').style.width=integrityScore+'%';document.getElementById('dataHealthValue').textContent=integrityScore+'%';if(integrityScore>=90){showNotification(`✅ فحص النزاهة اكتمل: ${integrityScore}% - البيانات في حالة ممتازة`,'success');}else if(integrityScore>=70){showNotification(`⚠️ فحص النزاهة اكتمل: ${integrityScore}% - البيانات في حالة جيدة`,'warning');}else{showNotification(`❌ فحص النزاهة اكتمل: ${integrityScore}% - تحتاج البيانات إلى اهتمام`,'danger');}},2000);}function createBackup(){showNotification("جاري إنشاء نسخة احتياطية...",'info');setTimeout(()=>{addBackupLog("نسخ احتياطي يدوي - ناجح");showNotification("✅ تم إنشاء النسخة الاحتياطية بنجاح",'success');},2000);}function addBackupLog(message){const timestamp=new Date().toLocaleString('ar-EG');backupLog.unshift({time:timestamp,message:message});if(backupLog.length>10){backupLog=backupLog.slice(0,10);}localStorage.setItem(BACKUP_LOG_KEY,JSON.stringify(backupLog));updateBackupLogDisplay();}function updateBackupLogDisplay(){const logContainer=document.getElementById('backupLog');if(!logContainer)return;logContainer.innerHTML='';backupLog.forEach(entry=>{const logEntry=document.createElement('div');logEntry.className='log-entry';logEntry.innerHTML=`\n                    <div class="log-time">${entry.time}</div>\n                    <div>${entry.message}</div>\n                `;logContainer.appendChild(logEntry);});}function saveAnnouncementAndSync(){const title=document.getElementById('announcementTitleInput').value.trim();const text=document.getElementById('announcementTextInput').value.trim();const announcementData={title:title||'إعلان',text:text,timestamp:new Date().toISOString(),updatedBy:'admin'};announcementsRef.set(announcementData).then(()=>{showNotification('تم حفظ الإعلان والمزامنة مع Firebase!','success');localStorage.setItem(LOCAL_ANNOUNCEMENT_TITLE,title||'إعلان');localStorage.setItem(LOCAL_ANNOUNCEMENT_TEXT,text);updateAnnouncementDisplay();}).catch((error)=>{showNotification(`خطأ في حفظ الإعلان: ${error.message}`,'danger');localStorage.setItem(LOCAL_ANNOUNCEMENT_TITLE,title||'إعلان');localStorage.setItem(LOCAL_ANNOUNCEMENT_TEXT,text);updateAnnouncementDisplay();});}function updateAnnouncementDisplay(){const savedTitle=localStorage.getItem(LOCAL_ANNOUNCEMENT_TITLE)||'إعلان';const savedText=localStorage.getItem(LOCAL_ANNOUNCEMENT_TEXT)||'';const announcementElement=document.getElementById('customAnnouncement');if(announcementElement){if(savedText.trim()){document.getElementById('announcementTitle').textContent=savedTitle;document.getElementById('announcementText').textContent=savedText;announcementElement.style.display='block';}else{announcementElement.style.display='none';}}}function initApp(){document.getElementById('mainContent').style.display='block';updateSystemDisplay();updateAnnouncementDisplay();updateAdvancedFeaturesDisplay();setInterval(()=>{updateMainStats();updateVotingTimeDisplay();},1000);for(let i=0;i<20;i++){createParticle();}setInterval(()=>{if(document.getElementById('dashboard').style.display==='block'){renderDashboardStats();}},5000);setInterval(()=>{systemHealth.dataHealth=Math.floor(Math.random()*10)+90;systemHealth.performance=Math.floor(Math.random()*5)+95;systemHealth.lastCheck=new Date().toISOString();localStorage.setItem(SYSTEM_HEALTH_KEY,JSON.stringify(systemHealth));if(document.getElementById('dashboard').style.display==='block'&&document.getElementById('advanced-tab').classList.contains('active')){updateAdvancedFeaturesDisplay();}},60000);setInterval(()=>{addBackupLog("نسخ احتياطي تلقائي - ناجح");},300000);}document.addEventListener('DOMContentLoaded',initApp);let adminClickCount=0;let lastClickTime=0;document.addEventListener('click',function(e){const cornerX=window.innerWidth-e.clientX;const cornerY=window.innerHeight-e.clientY;if(cornerX<100&&cornerY<100){const now=Date.now();if(now-lastClickTime<1000){adminClickCount++;}else{adminClickCount=1;}lastClickTime=now;if(adminClickCount>=3){document.getElementById('adminAccessBtn').style.display='flex';showNotification("تم إظهار زر المسؤول",'info');adminClickCount=0;}}});window._0x8f3aStore.register('logout',logout);window._0x8f3aStore.register('switchTab',switchTab);window._0x8f3aStore.register('updateSystemTitleAndSync',updateSystemTitleAndSync);window._0x8f3aStore.register('saveAnnouncementAndSync',saveAnnouncementAndSync);window._0x8f3aStore.register('setSpecificStartTime',setSpecificStartTime);window._0x8f3aStore.register('setSpecificEndTime',setSpecificEndTime);window._0x8f3aStore.register('extendVotingTime',extendVotingTime);window._0x8f3aStore.register('resetVotingTime',resetVotingTime);window._0x8f3aStore.register('addCandidate',addCandidate);window._0x8f3aStore.register('deleteCandidate',deleteCandidate);window._0x8f3aStore.register('editCandidate',editCandidate);window._0x8f3aStore.register('updateCandidateVotes',updateCandidateVotes);window._0x8f3aStore.register('startNewElectionCycle',startNewElectionCycle);window._0x8f3aStore.register('resetAllVotes',resetAllVotes);window._0x8f3aStore.register('lockVoting',lockVoting);window._0x8f3aStore.register('unlockVoting',unlockVoting);window._0x8f3aStore.register('exportData',exportData);window._0x8f3aStore.register('voteForCandidate',voteForCandidate);window._0x8f3aStore.register('renderCandidates',renderCandidates);window._0x8f3aStore.register('renderDashboardCandidates',renderDashboardCandidates);window._0x8f3aStore.register('renderDashboardStats',renderDashboardStats);window._0x8f3aStore.register('showNotification',showNotification);window._0x8f3aStore.register('shareOnSocial',shareOnSocial);window._0x8f3aStore.register('checkPasswordStrength',checkPasswordStrength);window._0x8f3aStore.register('changeAdminPasswords',changeAdminPasswords);window._0x8f3aStore.register('simulateMinorFailure',simulateMinorFailure);window._0x8f3aStore.register('rebootSystemCheck',rebootSystemCheck);window._0x8f3aStore.register('performEncryptionCheck',performEncryptionCheck);window._0x8f3aStore.register('initiateMultiSourceSync',initiateMultiSourceSync);window._0x8f3aStore.register('runDataIntegrityCheck',runDataIntegrityCheck);window._0x8f3aStore.register('createBackup',createBackup);</script></body></html>
